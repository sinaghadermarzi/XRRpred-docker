#!/usr/bin/perl
# norm is blosum/11
#
#  Program to make blosnorm input feature 
#  Eshel Faraggi 2007-2013 (C)
#

if ($#ARGV>=0)
  {
  $ff = $ARGV[0];
  open (PPFL, "$ff") or die "Can't find file $ff\n"; @indat = <PPFL>; close(PPFL);
  }
else
  {
  die "Use $0 dsspget_file\n";
  }

@aapp =
("A   0.4545 -0.1818 -0.1818 -0.1818 -0.0909 -0.0909 -0.0909  0.0000 -0.1818 -0.1818 -0.1818 -0.0909 -0.0909 -0.2727 -0.0909  0.0909  0.0000 -0.2727 -0.1818  0.0000 -0.1818 -0.1818 -0.0909 -0.0909 -0.5455",
"R  -0.1818  0.5455 -0.0909 -0.1818 -0.3636  0.0909 -0.0909 -0.2727  0.0000 -0.2727 -0.2727  0.1818 -0.1818 -0.3636 -0.1818 -0.0909 -0.0909 -0.3636 -0.2727 -0.2727 -0.0909 -0.2727  0.0000 -0.0909 -0.5455",
"N  -0.1818 -0.0909  0.5455  0.0909 -0.2727  0.0000 -0.0909 -0.0909  0.0000 -0.3636 -0.3636  0.0000 -0.2727 -0.3636 -0.2727  0.0000  0.0000 -0.3636 -0.2727 -0.3636  0.4545 -0.3636  0.0000 -0.0909 -0.5455",
"D  -0.1818 -0.1818  0.0909  0.5455 -0.3636 -0.0909  0.0909 -0.1818 -0.1818 -0.3636 -0.4545 -0.0909 -0.3636 -0.3636 -0.1818 -0.0909 -0.0909 -0.5455 -0.3636 -0.3636  0.4545 -0.4545  0.0909 -0.0909 -0.5455",
"C  -0.0909 -0.3636 -0.2727 -0.3636  0.8182 -0.3636 -0.4545 -0.3636 -0.3636 -0.1818 -0.1818 -0.3636 -0.1818 -0.2727 -0.3636 -0.1818 -0.0909 -0.2727 -0.2727 -0.0909 -0.3636 -0.1818 -0.3636 -0.0909 -0.5455",
"Q  -0.0909  0.0909  0.0000 -0.0909 -0.3636  0.5455  0.1818 -0.1818  0.0909 -0.2727 -0.2727  0.0909  0.0000 -0.3636 -0.1818  0.0000 -0.0909 -0.2727 -0.1818 -0.2727  0.0000 -0.2727  0.3636 -0.0909 -0.5455",
"E  -0.0909 -0.0909 -0.0909  0.0909 -0.4545  0.1818  0.5455 -0.2727  0.0000 -0.3636 -0.3636  0.0909 -0.1818 -0.3636 -0.1818  0.0000 -0.0909 -0.3636 -0.2727 -0.2727  0.0909 -0.3636  0.4545 -0.0909 -0.5455",
"G   0.0000 -0.2727 -0.0909 -0.1818 -0.3636 -0.1818 -0.2727  0.5455 -0.2727 -0.4545 -0.3636 -0.1818 -0.3636 -0.3636 -0.2727 -0.0909 -0.1818 -0.3636 -0.3636 -0.3636 -0.0909 -0.4545 -0.2727 -0.0909 -0.5455",
"H  -0.1818  0.0000  0.0000 -0.1818 -0.3636  0.0909  0.0000 -0.2727  0.7273 -0.3636 -0.2727 -0.0909 -0.1818 -0.1818 -0.2727 -0.0909 -0.1818 -0.2727  0.1818 -0.3636 -0.0909 -0.3636  0.0000 -0.0909 -0.5455",
"I  -0.1818 -0.2727 -0.3636 -0.3636 -0.1818 -0.2727 -0.3636 -0.4545 -0.3636  0.4545  0.0909 -0.2727  0.0909 -0.0909 -0.3636 -0.2727 -0.0909 -0.2727 -0.1818  0.2727 -0.3636  0.2727 -0.3636 -0.0909 -0.5455",
"L  -0.1818 -0.2727 -0.3636 -0.4545 -0.1818 -0.2727 -0.3636 -0.3636 -0.2727  0.0909  0.3636 -0.2727  0.1818  0.0000 -0.2727 -0.2727 -0.1818 -0.1818 -0.1818  0.0909 -0.3636  0.2727 -0.2727 -0.0909 -0.5455",
"K  -0.0909  0.1818  0.0000 -0.0909 -0.3636  0.0909  0.0909 -0.1818 -0.0909 -0.2727 -0.2727  0.4545 -0.1818 -0.3636 -0.0909 -0.0909 -0.0909 -0.3636 -0.2727 -0.2727 -0.0909 -0.2727  0.0909 -0.0909 -0.5455",
"M  -0.0909 -0.1818 -0.2727 -0.3636 -0.1818  0.0000 -0.1818 -0.3636 -0.1818  0.0909  0.1818 -0.1818  0.5455  0.0000 -0.2727 -0.1818 -0.0909 -0.1818 -0.1818  0.0909 -0.2727  0.1818 -0.0909 -0.0909 -0.5455",
"F  -0.2727 -0.3636 -0.3636 -0.3636 -0.2727 -0.3636 -0.3636 -0.3636 -0.1818 -0.0909  0.0000 -0.3636  0.0000  0.5455 -0.3636 -0.2727 -0.1818  0.0000  0.2727 -0.0909 -0.3636  0.0000 -0.3636 -0.0909 -0.5455",
"P  -0.0909 -0.1818 -0.2727 -0.1818 -0.3636 -0.1818 -0.1818 -0.2727 -0.2727 -0.3636 -0.2727 -0.0909 -0.2727 -0.3636  0.7273 -0.0909 -0.1818 -0.4545 -0.3636 -0.2727 -0.1818 -0.3636 -0.1818 -0.0909 -0.5455",
"S   0.0909 -0.0909  0.0000 -0.0909 -0.1818  0.0000  0.0000 -0.0909 -0.0909 -0.2727 -0.2727 -0.0909 -0.1818 -0.2727 -0.0909  0.4545  0.0909 -0.3636 -0.1818 -0.1818  0.0000 -0.2727  0.0000 -0.0909 -0.5455",
"T   0.0000 -0.0909  0.0000 -0.0909 -0.0909 -0.0909 -0.0909 -0.1818 -0.1818 -0.0909 -0.1818 -0.0909 -0.0909 -0.1818 -0.1818  0.0909  0.4545 -0.3636 -0.1818  0.0000 -0.0909 -0.0909 -0.0909 -0.0909 -0.5455",
"W  -0.2727 -0.3636 -0.3636 -0.5455 -0.2727 -0.2727 -0.3636 -0.3636 -0.2727 -0.2727 -0.1818 -0.3636 -0.1818  0.0000 -0.4545 -0.3636 -0.3636  1.0000  0.1818 -0.2727 -0.4545 -0.2727 -0.2727 -0.0909 -0.5455",
"Y  -0.1818 -0.2727 -0.2727 -0.3636 -0.2727 -0.1818 -0.2727 -0.3636  0.1818 -0.1818 -0.1818 -0.2727 -0.1818  0.2727 -0.3636 -0.1818 -0.1818  0.1818  0.6364 -0.1818 -0.2727 -0.1818 -0.2727 -0.0909 -0.5455",
"V   0.0000 -0.2727 -0.3636 -0.3636 -0.0909 -0.2727 -0.2727 -0.3636 -0.3636  0.2727  0.0909 -0.2727  0.0909 -0.0909 -0.2727 -0.1818  0.0000 -0.2727 -0.1818  0.3636 -0.3636  0.1818 -0.2727 -0.0909 -0.5455",
"B  -0.1818 -0.0909  0.4545  0.4545 -0.3636  0.0000  0.0909 -0.0909 -0.0909 -0.3636 -0.3636 -0.0909 -0.2727 -0.3636 -0.1818  0.0000 -0.0909 -0.4545 -0.2727 -0.3636  0.4545 -0.3636  0.0000 -0.0909 -0.5455",
"J  -0.1818 -0.2727 -0.3636 -0.4545 -0.1818 -0.2727 -0.3636 -0.4545 -0.3636  0.2727  0.2727 -0.2727  0.1818  0.0000 -0.3636 -0.2727 -0.0909 -0.2727 -0.1818  0.1818 -0.3636  0.2727 -0.2727 -0.0909 -0.5455",
"Z  -0.0909  0.0000  0.0000  0.0909 -0.3636  0.3636  0.4545 -0.2727  0.0000 -0.3636 -0.2727  0.0909 -0.0909 -0.3636 -0.1818  0.0000 -0.0909 -0.2727 -0.2727 -0.2727  0.0000 -0.2727  0.4545 -0.0909 -0.5455",
"X  -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.5455",
"*  -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455 -0.5455  0.0909",
"!   0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000",
"-  -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909 -0.0909");

@u = undef;
for (@aapp)
  {
  @tmp = split;
  $u{$tmp[0]} = substr($_,1);
  }

for (@indat)
  {
  @tmp = split;
  $cri = $tmp[0];
  $seq = $tmp[1];
  if (defined($u{$seq})) {
    printf(" %s %s %s\n",$cri,$seq,$u{$seq}); }
  else {
    printf(" %s %s %s\n",$cri,$seq,$u{"!"});
    print STDERR "Unknown residue $seq, in $ff\n";
    }
  }

__END__
