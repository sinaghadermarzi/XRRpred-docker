#!/usr/bin/perl
#
#  Program to make physpar input feature
#  Eshel Faraggi 2007-2013 (C)

if ($#ARGV>=0)
  {
  $ff = $ARGV[0];
  open (PPFL, "$ff") or die "Can't find file $ff\n"; @indat = <PPFL>; close(PPFL);
  }
else
  {
  die "Use $0 dsspget_file\n";
  }

@aapp =
(" A -0.3889 -0.7556 -0.7522 -0.1900 -0.1889 1.0000 -0.5289",
" C -0.1556 -0.3656 -0.3989 0.5644 -0.1267 -0.7244 0.5289",
" D -0.2367 -0.4633 -0.3122 -0.8522 -1.0000 -0.1722 -0.7056",
" E -0.2556 -0.2678 -0.0644 -0.7733 -0.9644 1.0000 -0.6467",
" F 0.4033 0.4144 0.4578 0.7178 -0.3022 0.1722 0.3533",
" G -1.0000 -1.0000 -1.0000 -0.3800 -0.1989 -1.0000 -1.0000",
" H 0.4267 0.1222 0.1533 -0.3011 0.2167 -0.0344 -0.1178",
" I 1.0000 -0.0733 -0.0100 0.7244 -0.2067 0.1722 0.7644",
" K -0.0978 0.0733 0.1811 -0.9878 0.8078 0.3100 -0.2944",
" L 0.2367 -0.0733 -0.0100 0.6622 -0.2067 0.7933 -0.0589",
" M 0.1222 0.0733 0.0967 0.3744 -0.2911 0.7244 -0.0011",
" N -0.2367 -0.3656 -0.2700 -0.7489 -0.0833 -0.4478 -0.5878",
" P 0.2744 -1.0000 -0.3267 0.0611 -0.0111 -1.0000 0.1178",
" Q -0.2556 -0.1222 -0.0222 -0.5156 -0.3067 0.5867 -0.4122",
" R 0.1167 0.4144 0.5178 -1.0000 1.0000 0.5867 -0.4122",
" S -0.3744 -0.7078 -0.6044 -0.4044 -0.2944 -0.5178 -0.2356",
" T 0.4467 -0.4633 -0.3567 -0.2211 -0.3200 -0.4478 0.2356",
" V 0.7522 -0.3167 -0.2578 0.3678 -0.2122 -0.0344 1.0000",
" W 0.5322 1.0000 1.0000 1.0000 -0.2322 0.3100 0.5878",
" Y 0.4033 0.4633 0.6011 0.2089 -0.3044 -0.1722 0.5289",
" X 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 ",
" B -0.2367 -0.4633 -0.3122 -0.8522 -1.0000 -0.1722 -0.7056",
" Z -0.2556 -0.2678 -0.0644 -0.7733 -0.9644 1.0000 -0.6467",
" ! -1.0000 -1.0000 -1.0000 -1.0000 -1.0000 -1.0000 -1.0000",
" - 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000");

@u = undef;
for (@aapp)
  {
  @tmp = split;
  $u{$tmp[0]} = substr($_,2);
  }

for (@indat)
  {
  @tmp = split;
  $cri = $tmp[0];
  $seq = $tmp[1];
  if (defined($u{$seq})) {
    printf(" %s %s %s\n",$cri,$seq,$u{$seq}); }
  else {
    printf(" %s %s %s\n",$cri,$seq,$u{"!"});
    print STDERR "Unknown residue $seq, in $ff\n";
    }
  }

__END__
